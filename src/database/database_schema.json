{
  "database_name": "umami.db",
  "tables": {
    "Associati": {
      "description": "Tabella madre che censisce tutti i soci dell'associazione e gestisce i legami familiari",
      "columns": {
        "id_associato": {
          "type": "INTEGER",
          "constraints": ["PRIMARY KEY", "AUTOINCREMENT"],
          "description": "Identificativo unico del socio"
        },
        "fk_associato_riferimento": {
          "type": "INTEGER",
          "constraints": ["REFERENCES Associati(id_associato)"],
          "nullable": true,
          "description": "Chiave auto-referenziante. Se valorizzato, punta all'id_associato del membro che paga per questo socio"
        },
        "nome": {
          "type": "VARCHAR(100)",
          "constraints": ["NOT NULL"],
          "description": "Nome di battesimo del socio"
        },
        "cognome": {
          "type": "VARCHAR(100)",
          "constraints": ["NOT NULL"],
          "description": "Cognome del socio"
        },
        "codice_fiscale": {
          "type": "VARCHAR(16)",
          "constraints": ["UNIQUE", "NOT NULL"],
          "description": "Codice Fiscale"
        },
        "data_nascita": {
          "type": "DATE",
          "constraints": ["NOT NULL"],
          "description": "Data di nascita"
        },
        "indirizzo": {
          "type": "VARCHAR(255)",
          "description": "Indirizzo di residenza completo"
        },
        "email": {
          "type": "VARCHAR(255)",
          "description": "Indirizzo email"
        },
        "telefono": {
          "type": "VARCHAR(20)",
          "description": "Numero di telefono"
        },
        "data_iscrizione": {
          "type": "DATE",
          "constraints": ["NOT NULL"],
          "description": "Data di prima iscrizione all'associazione"
        },
        "stato_associato": {
          "type": "VARCHAR(20)",
          "constraints": ["CHECK (stato_associato IN ('Attivo', 'Sospeso', 'Scaduto', 'Cessato'))"],
          "description": "Stato attuale del socio"
        }
      }
    },
    "ChiaviElettroniche": {
      "description": "Contiene i dati operativi per l'accesso ai locali e ai crediti per le docce",
      "columns": {
        "fk_associato": {
          "type": "INTEGER",
          "constraints": ["PRIMARY KEY", "REFERENCES Associati(id_associato)"],
          "description": "Collega questi dati a un unico socio. Agisce sia da Chiave Primaria che da Chiave Esterna"
        },
        "numero_tessera_fiv": {
          "type": "VARCHAR(50)",
          "constraints": ["UNIQUE"],
          "description": "Il numero di tessera ufficiale rilasciato dalla FIV"
        },
        "codice_accesso_locali": {
          "type": "VARCHAR(50)",
          "description": "Codice per l'accesso ai locali dell'associazione"
        },
        "credito_docce": {
          "type": "DECIMAL(10,2)",
          "default": "0.00",
          "description": "Credito disponibile per l'utilizzo delle docce"
        }
      }
    },
    "DatiTesseramentoFIV": {
      "description": "Dati specifici del tesseramento FIV separati per maggiore chiarezza",
      "columns": {
        "fk_associato": {
          "type": "INTEGER",
          "constraints": ["PRIMARY KEY", "REFERENCES Associati(id_associato)"],
          "description": "Riferimento al socio tesserato"
        },
        "numero_tessera_fiv": {
          "type": "VARCHAR(50)",
          "constraints": ["UNIQUE", "NOT NULL"],
          "description": "Numero tessera FIV"
        },
        "data_tesseramento_fiv": {
          "type": "DATE",
          "constraints": ["NOT NULL"],
          "description": "Data del tesseramento FIV"
        },
        "scadenza_certificato_medico": {
          "type": "DATE",
          "description": "Data di scadenza del certificato medico"
        },
        "stato_tesseramento": {
          "type": "VARCHAR(20)",
          "constraints": ["CHECK (stato_tesseramento IN ('Attivo', 'Sospeso', 'Scaduto'))"],
          "description": "Stato del tesseramento FIV"
        }
      }
    },
    "Fornitori": {
      "description": "Anagrafica dei fornitori dell'associazione",
      "columns": {
        "id_fornitore": {
          "type": "INTEGER",
          "constraints": ["PRIMARY KEY", "AUTOINCREMENT"],
          "description": "ID unico del fornitore"
        },
        "ragione_sociale": {
          "type": "VARCHAR(255)",
          "constraints": ["NOT NULL"],
          "description": "Ragione sociale del fornitore"
        },
        "partita_iva": {
          "type": "VARCHAR(11)",
          "constraints": ["UNIQUE"],
          "description": "Partita IVA del fornitore"
        },
        "codice_fiscale": {
          "type": "VARCHAR(16)",
          "description": "Codice fiscale del fornitore"
        },
        "indirizzo": {
          "type": "VARCHAR(255)",
          "description": "Indirizzo del fornitore"
        },
        "email": {
          "type": "VARCHAR(255)",
          "description": "Email del fornitore"
        },
        "telefono": {
          "type": "VARCHAR(20)",
          "description": "Telefono di contatto del fornitore"
        }
      }
    },
    "ServiziFisici": {
      "description": "Catalogo delle risorse fisiche tangibili e univoche",
      "columns": {
        "id_servizio_fisico": {
          "type": "INTEGER",
          "constraints": ["PRIMARY KEY", "AUTOINCREMENT"],
          "description": "ID unico del servizio fisico"
        },
        "nome": {
          "type": "VARCHAR(100)",
          "constraints": ["NOT NULL"],
          "description": "Nome del servizio fisico"
        },
        "descrizione": {
          "type": "TEXT",
          "description": "Descrizione dettagliata del servizio"
        },
        "categoria": {
          "type": "VARCHAR(50)",
          "description": "Categoria del servizio (es. 'Posto Barca', 'Armadietto')"
        },
        "stato": {
          "type": "VARCHAR(20)",
          "constraints": ["CHECK (stato IN ('Disponibile', 'Occupato', 'In Manutenzione'))"],
          "description": "Stato attuale della risorsa"
        }
      }
    },
    "PrezziServizi": {
      "description": "Prezzario dei servizi fisici",
      "columns": {
        "id_prezzo": {
          "type": "INTEGER",
          "constraints": ["PRIMARY KEY", "AUTOINCREMENT"],
          "description": "ID unico del prezzo"
        },
        "fk_servizio_fisico": {
          "type": "INTEGER",
          "constraints": ["REFERENCES ServiziFisici(id_servizio_fisico)", "NOT NULL"],
          "description": "Riferimento al servizio fisico"
        },
        "prezzo": {
          "type": "DECIMAL(10,2)",
          "constraints": ["NOT NULL"],
          "description": "Prezzo del servizio"
        },
        "data_validita_inizio": {
          "type": "DATE",
          "constraints": ["NOT NULL"],
          "description": "Data di inizio validità del prezzo"
        },
        "data_validita_fine": {
          "type": "DATE",
          "description": "Data di fine validità del prezzo"
        }
      }
    },
    "ServiziPrestazionali": {
      "description": "Catalogo dei servizi prestazionali offerti dall'associazione",
      "columns": {
        "id_prestazione": {
          "type": "INTEGER",
          "constraints": ["PRIMARY KEY", "AUTOINCREMENT"],
          "description": "ID unico della prestazione"
        },
        "nome": {
          "type": "VARCHAR(100)",
          "constraints": ["NOT NULL"],
          "description": "Nome della prestazione"
        },
        "descrizione": {
          "type": "TEXT",
          "description": "Descrizione della prestazione"
        },
        "prezzo": {
          "type": "DECIMAL(10,2)",
          "constraints": ["NOT NULL"],
          "description": "Prezzo della prestazione"
        },
        "categoria": {
          "type": "VARCHAR(50)",
          "description": "Categoria della prestazione"
        }
      }
    },
    "AssegnazioniServiziFisici": {
      "description": "Tabella ponte che collega un socio a un servizio fisico per un periodo",
      "columns": {
        "id_assegnazione": {
          "type": "INTEGER",
          "constraints": ["PRIMARY KEY", "AUTOINCREMENT"],
          "description": "ID unico dell'assegnazione"
        },
        "fk_associato": {
          "type": "INTEGER",
          "constraints": ["REFERENCES Associati(id_associato)", "NOT NULL"],
          "description": "Il socio che usufruisce del servizio"
        },
        "fk_servizio_fisico": {
          "type": "INTEGER",
          "constraints": ["REFERENCES ServiziFisici(id_servizio_fisico)", "NOT NULL"],
          "description": "Il servizio fisico assegnato"
        },
        "data_inizio": {
          "type": "DATE",
          "constraints": ["NOT NULL"],
          "description": "Data di inizio dell'assegnazione"
        },
        "data_fine": {
          "type": "DATE",
          "description": "Data di fine dell'assegnazione"
        },
        "stato": {
          "type": "VARCHAR(20)",
          "constraints": ["CHECK (stato IN ('Attivo', 'Terminato', 'Sospeso'))"],
          "description": "Stato dell'assegnazione"
        }
      }
    },
    "ErogazioniPrestazioni": {
      "description": "Registro delle prestazioni erogate ai soci",
      "columns": {
        "id_erogazione": {
          "type": "INTEGER",
          "constraints": ["PRIMARY KEY", "AUTOINCREMENT"],
          "description": "ID unico dell'erogazione"
        },
        "fk_associato": {
          "type": "INTEGER",
          "constraints": ["REFERENCES Associati(id_associato)", "NOT NULL"],
          "description": "Il socio che ha ricevuto la prestazione"
        },
        "fk_prestazione": {
          "type": "INTEGER",
          "constraints": ["REFERENCES ServiziPrestazionali(id_prestazione)", "NOT NULL"],
          "description": "La prestazione erogata"
        },
        "data_erogazione": {
          "type": "DATETIME",
          "constraints": ["NOT NULL"],
          "description": "Data dell'erogazione"
        }
      }
    },
    "Fatture": {
      "description": "Registro centrale di tutti i documenti contabili",
      "columns": {
        "id_fattura": {
          "type": "INTEGER",
          "constraints": ["PRIMARY KEY", "AUTOINCREMENT"],
          "description": "ID unico della fattura"
        },
        "numero_fattura": {
          "type": "VARCHAR(50)",
          "constraints": ["UNIQUE", "NOT NULL"],
          "description": "Numero progressivo della fattura"
        },
        "data_emissione": {
          "type": "DATE",
          "constraints": ["NOT NULL"],
          "description": "Data di emissione della fattura"
        },
        "data_scadenza": {
          "type": "DATE",
          "description": "Data di scadenza per il pagamento"
        },
        "fk_associato": {
          "type": "INTEGER",
          "constraints": ["REFERENCES Associati(id_associato)"],
          "nullable": true,
          "description": "Socio destinatario (per fatture attive)"
        },
        "fk_fornitore": {
          "type": "INTEGER",
          "constraints": ["REFERENCES Fornitori(id_fornitore)"],
          "nullable": true,
          "description": "Fornitore (per fatture passive)"
        },
        "tipo_fattura": {
          "type": "VARCHAR(20)",
          "constraints": ["CHECK (tipo_fattura IN ('Attiva', 'Passiva'))", "NOT NULL"],
          "description": "Tipo di fattura"
        },
        "importo_imponibile": {
          "type": "DECIMAL(10,2)",
          "constraints": ["NOT NULL"],
          "description": "Importo imponibile"
        },
        "importo_iva": {
          "type": "DECIMAL(10,2)",
          "constraints": ["NOT NULL"],
          "description": "Importo IVA"
        },
        "importo_totale": {
          "type": "DECIMAL(10,2)",
          "constraints": ["NOT NULL"],
          "description": "Importo totale"
        },
        "stato": {
          "type": "VARCHAR(20)",
          "constraints": ["CHECK (stato IN ('Emessa', 'Pagata', 'Scaduta', 'Annullata'))"],
          "description": "Stato della fattura"
        }
      }
    },
    "DettagliFatture": {
      "description": "Righe di dettaglio delle fatture",
      "columns": {
        "id_dettaglio": {
          "type": "INTEGER",
          "constraints": ["PRIMARY KEY", "AUTOINCREMENT"],
          "description": "ID unico della riga"
        },
        "fk_fattura": {
          "type": "INTEGER",
          "constraints": ["REFERENCES Fatture(id_fattura)", "NOT NULL"],
          "description": "La fattura a cui questa riga appartiene"
        },
        "descrizione": {
          "type": "TEXT",
          "constraints": ["NOT NULL"],
          "description": "Descrizione del servizio/prodotto"
        },
        "quantita": {
          "type": "DECIMAL(10,2)",
          "constraints": ["NOT NULL"],
          "description": "Quantità"
        },
        "prezzo_unitario": {
          "type": "DECIMAL(10,2)",
          "constraints": ["NOT NULL"],
          "description": "Prezzo unitario"
        },
        "importo_totale": {
          "type": "DECIMAL(10,2)",
          "constraints": ["NOT NULL"],
          "description": "Importo totale della riga"
        },
        "fk_assegnazione_servizio_fisico": {
          "type": "INTEGER",
          "constraints": ["REFERENCES AssegnazioniServiziFisici(id_assegnazione)"],
          "nullable": true,
          "description": "Link di tracciabilità al servizio fisico fatturato"
        },
        "fk_erogazione_servizio_prestazionale": {
          "type": "INTEGER",
          "constraints": ["REFERENCES ErogazioniPrestazioni(id_erogazione)"],
          "nullable": true,
          "description": "Link di tracciabilità al servizio prestazionale fatturato"
        }
      }
    },
    "Pagamenti": {
      "description": "Registro di tutti i movimenti di cassa/banca",
      "columns": {
        "id_pagamento": {
          "type": "INTEGER",
          "constraints": ["PRIMARY KEY", "AUTOINCREMENT"],
          "description": "ID unico del movimento"
        },
        "data_pagamento": {
          "type": "DATE",
          "constraints": ["NOT NULL"],
          "description": "Data effettiva del movimento di denaro"
        },
        "importo": {
          "type": "DECIMAL(10,2)",
          "constraints": ["NOT NULL"],
          "description": "Importo del movimento"
        },
        "metodo": {
          "type": "VARCHAR(20)",
          "constraints": ["CHECK (metodo IN ('Bonifico', 'POS', 'Contanti', 'Assegno'))", "NOT NULL"],
          "description": "Metodo di pagamento"
        },
        "fk_fattura": {
          "type": "INTEGER",
          "constraints": ["REFERENCES Fatture(id_fattura)", "NOT NULL"],
          "description": "La fattura che questo pagamento sta saldando"
        },
        "tipo": {
          "type": "VARCHAR(20)",
          "constraints": ["CHECK (tipo IN ('Entrata', 'Uscita'))", "NOT NULL"],
          "description": "Specifica se il denaro è entrato o uscito"
        }
      }
    }
  }
}
